# PPAM Alpha ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ë¬¸ì„œ (ìˆ˜ì •íŒ)

## ğŸ“Š ê°œìš”

PPAM Alpha ì•±ì˜ Firebase Firestore ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°ë¥¼ ì •ì˜í•œ ë¬¸ì„œì…ë‹ˆë‹¤. **ê¸°ì¡´ `posts`ì™€ `markers` ì»¬ë ‰ì…˜ì„ ìœ ì§€**í•˜ê³ , ìƒˆë¡œìš´ `post_instances` ì»¬ë ‰ì…˜ë§Œ ì¶”ê°€í•˜ì—¬ í¬ìŠ¤íŠ¸ í…œí”Œë¦¿ê³¼ ë°°í¬/ìˆ˜ì§‘ ì›Œí¬í”Œë¡œìš°ë¥¼ ê°œì„ í•©ë‹ˆë‹¤.

## ğŸ¯ í•µì‹¬ ê°œë…

### 1. í¬ìŠ¤íŠ¸ ì›Œí¬í”Œë¡œìš° 3ë‹¨ê³„
1. **í…œí”Œë¦¿ ìƒì„±**: ì‚¬ìš©ìê°€ Inboxì—ì„œ í¬ìŠ¤íŠ¸ í…œí”Œë¦¿ ìƒì„± (ë‹¨ê°€ë§Œ ì„¤ì •)
2. **ë§ˆì»¤ ë°°í¬**: Mapì—ì„œ í…œí”Œë¦¿ ì„ íƒ í›„ ìˆ˜ëŸ‰/ìœ„ì¹˜/ê¸°ê°„ ì„¤ì •í•˜ì—¬ ë§ˆì»¤ ë°°í¬
3. **ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ì§‘**: ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë§ˆì»¤ë¥¼ í„°ì¹˜í•˜ì—¬ ê°œì¸ í¬ìŠ¤íŠ¸ ì¸ìŠ¤í„´ìŠ¤ íšë“

### 2. ë°ì´í„° ê´€ê³„ë„
```
posts (í¬ìŠ¤íŠ¸ í…œí”Œë¦¿) âœ… ê¸°ì¡´ ìœ ì§€
    â†“ (1:N)
markers (ë°°í¬ëœ ë§ˆì»¤) âœ… ê¸°ì¡´ ìœ ì§€
    â†“ (1:N)
post_instances (ê°œì¸ ì¸ìŠ¤í„´ìŠ¤) ğŸ†• ì‹ ê·œ ìƒì„±
```

## ğŸ—‚ï¸ ì»¬ë ‰ì…˜ êµ¬ì¡° (ê¸°ì¡´ + ì‹ ê·œ)

### 1. `posts` - í¬ìŠ¤íŠ¸ í…œí”Œë¦¿ âœ… ê¸°ì¡´ ìœ ì§€
**ìš©ë„**: ì‚¬ìš©ìê°€ ìƒì„±í•œ í¬ìŠ¤íŠ¸ í…œí”Œë¦¿ (ì½˜í…ì¸  + ë‹¨ê°€)
**í˜„ì¬ ìƒíƒœ**: ì´ë¯¸ êµ¬í˜„ë˜ì–´ ìˆìŒ
**ìˆ˜ì • í•„ìš”**: ìƒì„±ì¼/ë§Œë£Œì¼ ê´€ë ¨ ë¡œì§ ì œê±°

```javascript
{
  "postId": "post_12345",
  "creatorId": "user_abc123",
  "creatorName": "ê¹€ì² ìˆ˜",
  "createdAt": "2025-01-15T09:00:00Z", // í…œí”Œë¦¿ ìƒì„±ì¼ë§Œ ìœ ì§€

  // í•µì‹¬ ì½˜í…ì¸ 
  "title": "ë§›ìˆëŠ” ì¹˜í‚¨ì§‘ í• ì¸ì¿ í°",
  "description": "ì˜¤ëŠ˜ í•˜ë£¨ë§Œ 20% í• ì¸!",
  "reward": 500,  // ë‹¨ê°€ (í¬ì¸íŠ¸)

  // ë¯¸ë””ì–´
  "mediaType": ["image", "text"],
  "mediaUrl": ["https://storage.../chicken.jpg"],
  "thumbnailUrl": ["https://storage.../chicken_thumb.jpg"],

  // íƒ€ê²ŸíŒ… ì¡°ê±´
  "targetAge": [20, 40],
  "targetGender": "all",
  "targetInterest": ["ìŒì‹", "í• ì¸"],
  "targetPurchaseHistory": ["ì¹˜í‚¨", "ë°°ë‹¬ìŒì‹"],

  // í–‰ë™ ì˜µì…˜
  "canRespond": true,
  "canForward": true,
  "canRequestReward": true,
  "canUse": true,

  // âŒ ì œê±°í•  í•„ë“œë“¤:
  // "expiresAt": ë§Œë£Œì¼ ì œê±° (ë°°í¬ ì‹œì— ê²°ì •)
  // "location": ìœ„ì¹˜ ì œê±° (ë§ˆì»¤ì—ì„œ ê²°ì •)
  // "radius": ë°˜ê²½ ì œê±° (ë§ˆì»¤ì—ì„œ ê²°ì •)
  // "quantity": ìˆ˜ëŸ‰ ì œê±° (ë§ˆì»¤ì—ì„œ ê²°ì •)

  // ìƒíƒœ ë° í†µê³„
  "status": "active",  // active, inactive, deleted
  "isActive": true,
  "totalDeployments": 0,  // ë°°í¬ëœ íšŸìˆ˜ (ìƒˆë¡œ ì¶”ê°€)
  "totalInstances": 0,    // ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ (ìƒˆë¡œ ì¶”ê°€)

  // ì¿ í° ì‹œìŠ¤í…œ (ì„ íƒ)
  "isCoupon": true,
  "couponData": {
    "type": "discount",
    "value": 20,
    "unit": "percent"
  }
}
```

**ì£¼ìš” íŠ¹ì§•**:
- âœ… **ê¸°ì¡´ êµ¬ì¡° ìœ ì§€**: í˜„ì¬ PostServiceì™€ í˜¸í™˜
- âŒ **ë§Œë£Œì¼ ì œê±°**: `expiresAt` í•„ë“œ ì‚¬ìš© ì¤‘ë‹¨
- âŒ **ìœ„ì¹˜/ìˆ˜ëŸ‰ ì •ë³´ ì œê±°**: ë§ˆì»¤ ë°°í¬ ì‹œì—ë§Œ ì„¤ì •
- âœ… **ë‹¨ê°€ ì¤‘ì‹¬**: `reward` í•„ë“œë¡œ í¬ì¸íŠ¸ ë‹¨ê°€ë§Œ ê´€ë¦¬
- âœ… **ì¬ì‚¬ìš© ê°€ëŠ¥**: ê°™ì€ í…œí”Œë¦¿ìœ¼ë¡œ ì—¬ëŸ¬ ë²ˆ ë°°í¬ ê°€ëŠ¥

### 2. `markers` - ë°°í¬ëœ ë§ˆì»¤ âœ… ê¸°ì¡´ ìœ ì§€
**ìš©ë„**: íŠ¹ì • í…œí”Œë¦¿ì˜ ë°°í¬ ì •ë³´ (ìœ„ì¹˜, ìˆ˜ëŸ‰, ê¸°ê°„)
**í˜„ì¬ ìƒíƒœ**: ì´ë¯¸ êµ¬í˜„ë˜ì–´ ìˆìŒ
**ìˆ˜ì • í•„ìš”**: posts ì—°ë™ ë¡œì§ ê°œì„ 

```javascript
{
  "markerId": "marker_67890",
  "postId": "post_12345",  // ì›ë³¸ í…œí”Œë¦¿ ì°¸ì¡°
  "creatorId": "user_abc123",

  // ë°°í¬ ìœ„ì¹˜ (Mapì—ì„œ ì„¤ì •)
  "location": {
    "_latitude": 37.5665,
    "_longitude": 126.9780
  },
  "radius": 1000,  // ë…¸ì¶œ ë°˜ê²½ (ë¯¸í„°)

  // ë°°í¬ ìˆ˜ëŸ‰ (Mapì—ì„œ ì„¤ì •)
  "totalQuantity": 10,      // ì´ ë°°í¬ ìˆ˜ëŸ‰
  "remainingQuantity": 7,   // ë‚¨ì€ ìˆ˜ëŸ‰
  "collectedQuantity": 3,   // ìˆ˜ì§‘ëœ ìˆ˜ëŸ‰

  // ë°°í¬ ê¸°ê°„ (Mapì—ì„œ ì„¤ì •)
  "startDate": "2025-01-15T10:00:00Z",
  "endDate": "2025-01-22T10:00:00Z",
  "createdAt": "2025-01-15T10:30:00Z", // ë§ˆì»¤ ìƒì„±ì¼

  // ë§ˆì»¤ ìƒíƒœ
  "isActive": true,
  "status": "active",  // active, expired, paused, deleted

  // ì„±ëŠ¥ ìµœì í™” (ê¸°ì¡´ ìœ ì§€)
  "tileId": "tile_123_456",
  "s2_10": "s2cell_level10_id",
  "s2_12": "s2cell_level12_id",
  "isSuperPost": false,

  // í†µê³„
  "viewCount": 15,
  "collectionRate": 0.3  // 30% ìˆ˜ì§‘ë¥ 
}
```

**ì£¼ìš” íŠ¹ì§•**:
- âœ… **ê¸°ì¡´ MarkerService ìœ ì§€**: í˜„ì¬ ë§ˆì»¤ ê´€ë ¨ ë¡œì§ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- âœ… **ë°°í¬ ì„¤ì • ì™„ë£Œ**: ìœ„ì¹˜, ìˆ˜ëŸ‰, ê¸°ê°„ì„ Mapì—ì„œ ì„¤ì •
- âœ… **ì‹¤ì‹œê°„ ìˆ˜ëŸ‰ ê´€ë¦¬**: ìˆ˜ì§‘ë  ë•Œë§ˆë‹¤ `remainingQuantity` ê°ì†Œ
- âœ… **ì§€ë„ ì—°ë™ ì™„ë£Œ**: ê¸°ì¡´ ì§€ë„ ì‹œìŠ¤í…œê³¼ í˜¸í™˜

### 3. `post_instances` - ê°œì¸ í¬ìŠ¤íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ğŸ†• ì‹ ê·œ ìƒì„±
**ìš©ë„**: ì‚¬ìš©ìê°€ ìˆ˜ì§‘í•œ ê°œë³„ í¬ìŠ¤íŠ¸ (í…œí”Œë¦¿ì˜ ìŠ¤ëƒ…ìƒ· ë³µì‚¬ë³¸)
**í˜„ì¬ ìƒíƒœ**: ìƒˆë¡œ ìƒì„± í•„ìš”
**ëŒ€ì²´ ëŒ€ìƒ**: ê¸°ì¡´ `post_collections` (ì°¸ì¡° â†’ ìŠ¤ëƒ…ìƒ·)

```javascript
{
  "instanceId": "instance_xyz789",
  "postId": "post_12345",        // ì›ë³¸ í…œí”Œë¦¿ ì°¸ì¡° (posts)
  "markerId": "marker_67890",    // ë°°í¬ ë§ˆì»¤ ì°¸ì¡° (markers)
  "userId": "user_def456",       // ìˆ˜ì§‘í•œ ì‚¬ìš©ì

  // ìˆ˜ì§‘ ì •ë³´
  "collectedAt": "2025-01-15T14:20:00Z",
  "collectedLocation": {
    "_latitude": 37.5665,
    "_longitude": 126.9780
  },

  // ì‚¬ìš© ì •ë³´
  "usedAt": null,
  "usedLocation": null,
  "usedNote": null,
  "isUsed": false,

  // ì¸ìŠ¤í„´ìŠ¤ ìƒíƒœ
  "status": "collected",  // collected, used, expired, deleted
  "isActive": true,

  // í…œí”Œë¦¿ ë°ì´í„° ìŠ¤ëƒ…ìƒ· (ìˆ˜ì§‘ ì‹œì ì˜ ë³µì‚¬ë³¸)
  "creatorId": "user_abc123",
  "creatorName": "ê¹€ì² ìˆ˜",
  "title": "ë§›ìˆëŠ” ì¹˜í‚¨ì§‘ í• ì¸ì¿ í°",
  "description": "ì˜¤ëŠ˜ í•˜ë£¨ë§Œ 20% í• ì¸!",
  "reward": 500,
  "mediaType": ["image", "text"],
  "mediaUrl": ["https://storage.../chicken.jpg"],
  "thumbnailUrl": ["https://storage.../chicken_thumb.jpg"],

  // íƒ€ê²ŸíŒ… ì •ë³´ (ìŠ¤ëƒ…ìƒ·)
  "targetAge": [20, 40],
  "targetGender": "all",
  "targetInterest": ["ìŒì‹", "í• ì¸"],
  "targetPurchaseHistory": ["ì¹˜í‚¨", "ë°°ë‹¬ìŒì‹"],

  // í–‰ë™ ì˜µì…˜ (ìŠ¤ëƒ…ìƒ·)
  "canRespond": true,
  "canForward": true,
  "canRequestReward": true,
  "canUse": true,

  // ë§Œë£Œ ì •ë³´ (ë§ˆì»¤ì—ì„œ ë³µì‚¬)
  "expiresAt": "2025-01-22T10:00:00Z", // ë§ˆì»¤ì˜ endDate

  // ì „ë‹¬/ì‘ë‹µ ê´€ë ¨
  "forwardedFrom": null,
  "forwardedAt": null,
  "responses": [],

  // ì¿ í° ì •ë³´ (ìŠ¤ëƒ…ìƒ·)
  "isCoupon": true,
  "couponData": {
    "type": "discount",
    "value": 20,
    "unit": "percent"
  }
}
```

**ì£¼ìš” íŠ¹ì§•**:
- ğŸ†• **ì™„ì „ ì‹ ê·œ ì»¬ë ‰ì…˜**: ê¸°ì¡´ ì‹œìŠ¤í…œì— ì˜í–¥ ì—†ìŒ
- âœ… **ì™„ì „í•œ ìŠ¤ëƒ…ìƒ·**: ìˆ˜ì§‘ ì‹œì ì˜ í…œí”Œë¦¿ ë°ì´í„°ë¥¼ ëª¨ë‘ ë³µì‚¬
- âœ… **ë…ë¦½ì  ê´€ë¦¬**: ì›ë³¸ í…œí”Œë¦¿ ë³€ê²½ì— ì˜í–¥ë°›ì§€ ì•ŠìŒ
- âœ… **ë§Œë£Œì¼ ì ìš©**: ë§ˆì»¤ì˜ `endDate`ë¥¼ `expiresAt`ìœ¼ë¡œ ë³µì‚¬
- âœ… **ê¸°ì¡´ ëŒ€ì²´**: `post_collections` ì»¬ë ‰ì…˜ ê¸°ëŠ¥ì„ ì™„ì „ ëŒ€ì²´

## ğŸ”„ ì›Œí¬í”Œë¡œìš° ìƒì„¸

### 1. í…œí”Œë¦¿ ìƒì„± (Inbox) - ê¸°ì¡´ ìœ ì§€
```mermaid
graph LR
    A[ì‚¬ìš©ì] --> B[Inbox í™”ë©´]
    B --> C[í¬ìŠ¤íŠ¸ ìƒì„±]
    C --> D[ì œëª©/ì„¤ëª…/ì´ë¯¸ì§€ ì…ë ¥]
    D --> E[ë‹¨ê°€ ì„¤ì •]
    E --> F[posts ì»¬ë ‰ì…˜ ì €ì¥]
    F --> G[í…œí”Œë¦¿ ì™„ì„±]
```

**ê¸°ì¡´ PostService ì‚¬ìš©**:
- `createPost()` ë©”ì„œë“œ í™œìš©
- ë§Œë£Œì¼ ê´€ë ¨ íŒŒë¼ë¯¸í„°ë§Œ ì œê±°

### 2. ë§ˆì»¤ ë°°í¬ (Map) - ê¸°ì¡´ ìœ ì§€
```mermaid
graph LR
    A[Map í™”ë©´] --> B[í…œí”Œë¦¿ ì„ íƒ]
    B --> C[ìœ„ì¹˜ ì„¤ì •]
    C --> D[ìˆ˜ëŸ‰ ì„¤ì •]
    D --> E[ê¸°ê°„ ì„¤ì •]
    E --> F[markers ì»¬ë ‰ì…˜ ì €ì¥]
    F --> G[ë§ˆì»¤ ìƒì„±]
```

**ê¸°ì¡´ MarkerService ì‚¬ìš©**:
- `createMarker()` ë©”ì„œë“œ í™œìš©
- postsì™€ markers ì—°ë™ ê°œì„ 

### 3. í¬ìŠ¤íŠ¸ ìˆ˜ì§‘ (Map) - ì‹ ê·œ êµ¬í˜„ í•„ìš”
```mermaid
graph LR
    A[ë‹¤ë¥¸ ì‚¬ìš©ì] --> B[ë§ˆì»¤ í„°ì¹˜]
    B --> C[í…œí”Œë¦¿ ìŠ¤ëƒ…ìƒ· ë³µì‚¬]
    C --> D[post_instances ì €ì¥]
    D --> E[ë§ˆì»¤ ìˆ˜ëŸ‰ ê°ì†Œ]
    E --> F[ìˆ˜ì§‘ ì™„ë£Œ]
```

**ìƒˆë¡œìš´ PostInstanceService í•„ìš”**:
- `collectPost()` ë©”ì„œë“œ êµ¬í˜„
- í…œí”Œë¦¿ â†’ ì¸ìŠ¤í„´ìŠ¤ ë³µì‚¬ ë¡œì§

## ğŸ“ˆ ê¸°ì¡´ ì»¬ë ‰ì…˜ê³¼ì˜ ê´€ê³„

### ìœ ì§€ë˜ëŠ” ì»¬ë ‰ì…˜ë“¤

#### `posts` âœ… ìœ ì§€
- **ì—­í• **: í¬ìŠ¤íŠ¸ í…œí”Œë¦¿
- **ìˆ˜ì •ì‚¬í•­**: ë§Œë£Œì¼ ê´€ë ¨ ë¡œì§ë§Œ ì œê±°
- **í˜¸í™˜ì„±**: ê¸°ì¡´ PostService ê·¸ëŒ€ë¡œ ì‚¬ìš©

#### `markers` âœ… ìœ ì§€
- **ì—­í• **: ë°°í¬ëœ ë§ˆì»¤
- **ìˆ˜ì •ì‚¬í•­**: posts ì—°ë™ ë¡œì§ ê°œì„ 
- **í˜¸í™˜ì„±**: ê¸°ì¡´ MarkerService ê·¸ëŒ€ë¡œ ì‚¬ìš©

#### `post_usage` âœ… ìœ ì§€
- **ì—­í• **: í¬ì¸íŠ¸ ì§€ê¸‰ ë° ì‚¬ìš© ê¸°ë¡ ê´€ë¦¬
- **ì—°ë™**: `post_instances`ì˜ `usedAt` í•„ë“œì™€ ì—°ë™

### ëŒ€ì²´ë˜ëŠ” ì»¬ë ‰ì…˜ë“¤

#### `post_collections` â†’ `post_instances` ğŸ”„ ì ì§„ì  ëŒ€ì²´
- **ë¬¸ì œì **: ì°¸ì¡°ë§Œ ì €ì¥, ì‹¤ì œ ë°ì´í„° ë³µì‚¬ ì—†ìŒ
- **í•´ê²°ì±…**: `post_instances`ë¡œ ì™„ì „ ëŒ€ì²´ (ìŠ¤ëƒ…ìƒ· ë°©ì‹)
- **ë§ˆì´ê·¸ë ˆì´ì…˜**: ê¸°ì¡´ ë°ì´í„°ë¥¼ ìƒˆ êµ¬ì¡°ë¡œ ë³€í™˜

#### `flyers` ğŸ“‹ ë¶„ì„ í•„ìš”
- **í˜„ì¬**: ì¼ë¶€ í¬ìŠ¤íŠ¸ ë°ì´í„° ì €ì¥
- **ê³„íš**: ìš©ë„ í™•ì¸ í›„ ë§ˆì´ê·¸ë ˆì´ì…˜ ë˜ëŠ” ì œê±°

## ğŸ” ì¿¼ë¦¬ íŒ¨í„´ (ê¸°ì¡´ + ì‹ ê·œ)

### ë‚´ í¬ìŠ¤íŠ¸ í…œí”Œë¦¿ ì¡°íšŒ (ê¸°ì¡´ ìœ ì§€)
```javascript
// Inbox "ë‚´ í¬ìŠ¤íŠ¸" íƒ­ - ê¸°ì¡´ PostService ì‚¬ìš©
db.collection('posts')
  .where('creatorId', '==', userId)
  .where('isActive', '==', true)
  .orderBy('createdAt', 'desc')
```

### ë‚´ê°€ ìˆ˜ì§‘í•œ í¬ìŠ¤íŠ¸ ì¡°íšŒ (ì‹ ê·œ)
```javascript
// Inbox "ë°›ì€ í¬ìŠ¤íŠ¸" íƒ­ - ìƒˆë¡œìš´ PostInstanceService ì‚¬ìš©
db.collection('post_instances')
  .where('userId', '==', userId)
  .where('status', 'in', ['collected', 'used'])
  .orderBy('collectedAt', 'desc')
```

### ì§€ë„ì—ì„œ ë§ˆì»¤ ì¡°íšŒ (ê¸°ì¡´ ìœ ì§€)
```javascript
// Map í™”ë©´ - ê¸°ì¡´ MarkerService ì‚¬ìš©
db.collection('markers')
  .where('isActive', '==', true)
  .where('endDate', '>', new Date())
  .where('remainingQuantity', '>', 0)
  .where('s2_10', 'in', s2CellIds)
```

### í…œí”Œë¦¿-ë§ˆì»¤ ì—°ë™ ì¡°íšŒ (ê°œì„ )
```javascript
// íŠ¹ì • í…œí”Œë¦¿ì˜ ëª¨ë“  ë§ˆì»¤ í˜„í™©
db.collection('markers')
  .where('postId', '==', postId)
  .where('isActive', '==', true)
  .orderBy('createdAt', 'desc')
```

## ğŸš€ êµ¬í˜„ ì „ëµ

### Phase 1: ìµœì†Œ ë³€ê²½ìœ¼ë¡œ ì‹ ê·œ ê¸°ëŠ¥ ì¶”ê°€
1. **PostInstanceModel ìƒì„±** âœ… ì™„ë£Œ
2. **PostInstanceService ìƒì„±** - ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
3. **ìˆ˜ì§‘ ì›Œí¬í”Œë¡œìš° êµ¬í˜„** - ë§ˆì»¤ â†’ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
4. **Inbox ë°›ì€ í¬ìŠ¤íŠ¸ ì—°ë™** - ê¸°ì¡´ post_collections ëŒ€ì‹  post_instances ì‚¬ìš©

### Phase 2: ê¸°ì¡´ ì‹œìŠ¤í…œ ê°œì„ 
1. **PostModel ì •ë¦¬** - ë§Œë£Œì¼ ê´€ë ¨ í•„ë“œ ì œê±°
2. **PostService ê°œì„ ** - í…œí”Œë¦¿ ì¤‘ì‹¬ ë¡œì§ìœ¼ë¡œ ë³€ê²½
3. **MarkerService ì—°ë™** - postsì™€ markers ê´€ê³„ ê°œì„ 

### Phase 3: ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜
1. **post_collections â†’ post_instances** ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
2. **ì–‘ë°©í–¥ í˜¸í™˜ì„± ìœ ì§€** - ê¸°ì¡´ ì•±ê³¼ ì‹ ê·œ ì•± ë™ì‹œ ì§€ì›
3. **ì„±ëŠ¥ ìµœì í™”** - ìƒˆë¡œìš´ ì¸ë±ìŠ¤ ìƒì„±

### Phase 4: ì™„ì „ ì „í™˜
1. **ëª¨ë“  ê¸°ëŠ¥ì„ ìƒˆ êµ¬ì¡°ë¡œ ì „í™˜**
2. **ë ˆê±°ì‹œ ì»¬ë ‰ì…˜ ì •ë¦¬**
3. **ìµœì¢… ì„±ëŠ¥ ìµœì í™”**

## ğŸ”§ ì¸ë±ìŠ¤ ì„¤ì •

### ê¸°ì¡´ ì¸ë±ìŠ¤ ìœ ì§€

#### `posts`
```javascript
// ê¸°ì¡´ ì¸ë±ìŠ¤ ê·¸ëŒ€ë¡œ ì‚¬ìš©
{ "creatorId": 1, "createdAt": -1 }
{ "creatorId": 1, "isActive": 1 }
```

#### `markers`
```javascript
// ê¸°ì¡´ ì¸ë±ìŠ¤ ê·¸ëŒ€ë¡œ ì‚¬ìš©
{ "isActive": 1, "endDate": 1, "s2_10": 1 }
{ "postId": 1, "isActive": 1 }
```

### ì‹ ê·œ ì¸ë±ìŠ¤ ì¶”ê°€

#### `post_instances` ğŸ†•
```javascript
// ìƒˆë¡œ ìƒì„±í•  ì¸ë±ìŠ¤
{ "userId": 1, "collectedAt": -1 }
{ "userId": 1, "status": 1, "collectedAt": -1 }
{ "postId": 1, "collectedAt": -1 }
{ "markerId": 1, "collectedAt": -1 }
```

## ğŸ“Š í†µê³„ ë° ë¶„ì„

### í…œí”Œë¦¿ ì„±ê³¼ ë¶„ì„
- `posts.totalDeployments` - ì´ ë°°í¬ íšŸìˆ˜
- `posts.totalInstances` - ì´ ìˆ˜ì§‘ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜
- ìˆ˜ì§‘ë¥  = ì´ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ / ì´ ë°°í¬ ìˆ˜ëŸ‰

### ë§ˆì»¤ ì„±ê³¼ ë¶„ì„ (ê¸°ì¡´ ìœ ì§€)
- `markers.collectionRate` - ìˆ˜ì§‘ë¥ 
- ë…¸ì¶œ ëŒ€ë¹„ ìˆ˜ì§‘ë¥  (`collectedQuantity / viewCount`)
- ì§€ì—­ë³„/ì‹œê°„ëŒ€ë³„ ì„±ê³¼

### ì‚¬ìš©ì í–‰ë™ ë¶„ì„
- ìˆ˜ì§‘ íŒ¨í„´ (ì‹œê°„, ìœ„ì¹˜, ì¹´í…Œê³ ë¦¬)
- ì‚¬ìš©ë¥  (ìˆ˜ì§‘ í›„ ì‹¤ì œ ì‚¬ìš© ë¹„ìœ¨)
- ì „ë‹¬/ì‘ë‹µ í™œë™

## ğŸ” Firebase MCP ì—°ë™

### ì„¤ì¹˜ ë° ì„¤ì •
```bash
# Firebase MCP ì„œë²„ ì„¤ì¹˜ âœ… ì™„ë£Œ
npm install -g @gannonh/firebase-mcp

# Claude Codeì— MCP ì„œë²„ ì¶”ê°€ âœ… ì™„ë£Œ
claude mcp add firebase npx @gannonh/firebase-mcp

# Firebase í”„ë¡œì íŠ¸ í™•ì¸ âœ… ì™„ë£Œ
Project: ppamproto-439623 (current)
```

### í™œìš© ê°€ëŠ¥í•œ ê¸°ëŠ¥
- Firestore ì»¬ë ‰ì…˜ ì§ì ‘ ì¡°íšŒ/ìˆ˜ì •
- ì‹¤ì‹œê°„ ë°ì´í„° ëª¨ë‹ˆí„°ë§
- ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸
- ë³´ì•ˆ ê·œì¹™ ê²€ì¦

---

**ë¬¸ì„œ ë²„ì „**: v2.0 (ê¸°ì¡´ êµ¬ì¡° ë°˜ì˜)
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-09-26
**ì‘ì„±ì**: Claude Code Assistant
**ì£¼ìš” ë³€ê²½ì‚¬í•­**: ê¸°ì¡´ posts/markers ì»¬ë ‰ì…˜ ìœ ì§€, post_instancesë§Œ ì‹ ê·œ ì¶”ê°€