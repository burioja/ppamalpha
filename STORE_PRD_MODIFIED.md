# 마이페이지 PRD(Project Requirements Document)

상태: 대기 중
우선순위: 중간 높음
진행률: 50%
마감일: July 29, 2025
담당자: TS Y
카테고리: 문서화
메모: 사용자의 과거 주문 내역을 가져오는 API 연동 작업. 백엔드 작업 완료 후 시작 예정.

# 마이페이지 PRD (Product Requirements Document)

## 1. 개요

### 1.1 목적

기존 스토어 페이지를 마이페이지로 리팩토링하여 사용자의 다양한 아이덴티티(워크모드/라이프모드)에 따른 개인화된 관리 기능을 제공합니다.

### 1.2 핵심 컨셉

- **다중 아이덴티티**: 한 사용자가 여러 워크플레이스/플레이스 에 따라 다양한 역할을 수행   <문구수정>
- **모드 기반 관리**: 워크모드와 라이프모드에 따른 차별화된 기능 제공
- **역할 기반 접근**: 워크플레이스/플레이스 별 역할에 따른 권한과 기능 제어

### 1.3 요구사항 분석 Q&A

### Q1. 사용자의 다중 아이덴티티는 어떻게 구현되나요?

**A1.** 한 사람이 다양한 아이덴티티를 갖도록 설계했습니다. 예를 들어:

- 가게 관리자 (워크모드)
- 직원 (워크모드)
- 고객 (워크/라이프모드)
- 개인/동호회/모임 구성원 (라이프모드)

### Q2. 스케줄 공유는 어떻게 작동하나요?

**A2.** 스케줄 생성 시 3가지 공유범위 중 선택:

- **플레이스 공유**: 본인 + 공유한 사용자(제3자) + 트랙킹 한 사람에게만 표시(고객 정보 표시)
- **워크플레이스 공유**: 해당 워크플레이스 인원들에게만 표시

(공개 삭제)

### Q3. 워크플레이스별 권한은 어떻게 관리되나요?

**A3.** 워크플레이스별로 다양한 역할명 사용 가능:

- 소유자 계열: Owner, 사장, 대표, 캡틴 등
- 관리자 계열: Manager, 매니저, 보조캡틴 등
- 직원 계열: Employee, 직원, 스태프 등
- 고객 계열: Customer, 손님, 회원 등

### Q4. 모드 전환은 어떻게 작동하나요?

**A4.** 상단에 워크모드/라이프모드는 Topbar에 색상과 문구 변경으로 계속 표시되며:

       하단 Bottom Naviagation에서

- **워크모드**: 워크플레이스 드래그로 선택 가능
- **라이프모드**: 플레이스(개인/동호회/모임) 드래그로 선택 가능

### Q5. 직원 관리 기능은 누가 사용할 수 있나요?

**A5.** 소유자/관리자만 사용 가능:

- 직원 목록 조회 및 관리
- 출근 기록 확인
- 급여 정산 시스템
- 직급별 권한 관리

### Q6. 기존 데이터는 어떻게 마이그레이션되나요?

**A6.** 안전한 마이그레이션을 위해:

- 모든 기존 스케줄을 "개인용"으로 설정
- 소유자가 필요에 따라 수동으로 공유범위 변경
- 데이터 손실 방지

### 1.4 PPAM 전단지 플랫폼 컨셉

### 1.4.1 핵심 아이디어

PPAM은 **리워드형 전단지 플랫폼**으로, 기존 광고의 한계를 보완하는 새로운 마케팅 방식입니다:

**기존 광고의 문제점:**

- 전단지: 인근 유동인구 랜덤 배포로 타겟팅 부족
- 온라인 광고: 알고리즘 기반으로 개인정보 침해 우려, 높은 시간 의존도
- 방송/신문: 높은 비용과 낮은 전환율, 높은 시간 의존도

**PPAM의 해결책:**

- **지도 기반 타겟팅**: 소비자가 능동적으로 이동하여 전단지 수령(잠재고객 가능성 높음)
- **리워드 시스템**: 전단지 수령 시 보상 지급으로 참여 동기 부여
- **정량적 효과 분석**: 방문 기록, 구매 이력 등 실질적인 광고 효과 측정

### 1.4.2 전단지 유형 및 역할

**리워드형 포스트(PPAM) 유형:**

1. **전단지**: 판매자가 특정 상품/서비스 홍보 목적
2. **팜플렛**: 행사, 쇼핑몰, 놀이공원 등 방문자 안내 목적
3. **안내문**: 특정 사실 및 정보 안내 목적
4. **퀘스트**: 요구자가 수행자를 선정하고 보상 지급

**사용자 역할:**

- **발행자**: 전단지/팜플렛/안내문/퀘스트 배포 주체
- **소비자**: 전단지 수취 대상
- **참가자**: 팜플렛 수취 대상
- **관계인**: 안내문 수취 대상
- **수행자**: 퀘스트 수행 대상

### 1.4.3 전단지 배포 및 수령 방식

**배포 방법:**

- **거점형 전단지**: 지도에서 위치 선택 후 수량만큼 배포
- **주소형 전단지**: 주소 선택 후 세대 수에 따른 배포
- **업체별 전단지**: 업체명/업종/지역 선택 후 배포

**수령 방법:**

- **지도 기반**: 전단지 마크가 있는 위치로 이동 후 수령
- **자동 수령**: 입력된 주소/직장에 따라 자동 습득
- **퀘스트**: 퀘스트창 또는 퀘스트 마크 있는 위치로 이동 후 수령

### 1.4.4 전단지 지갑 시스템

**지갑 기능:**

- **수령한 전단지 관리**: 받은 전단지의 체계적 관리
- **용도별 필터링**: 전단지 유형에 따른 분류 및 검색
- **대화창 기능**: 전단지 관련 커뮤니케이션
- **초성 이동**: 카카오톡 친구목록과 유사한 UI 구조

**지갑 데이터 구조:**

- 전단지 이미지 및 메타데이터 저장
- 수령 시간, 발행자 정보, 리워드 정보
- 사용 여부, 만료일, 공유 가능 여부

## 2. 사용자 역할 및 권한

### 2.1 역할 정의

워크플레이스별로 다양한 역할명 사용 가능 (예시):

- **소유자 계열**: Owner, 사장, 대표, 캡틴 등
- **관리자 계열**: Manager, 매니저, 보조캡틴 등
- **직원 계열**: Employee, 직원, 스태프 등
- **고객 계열**: Customer, 손님, 회원 등

### 2.2 권한 레벨

1. **소유자/관리자 권한**: 직원관리, 급여정산, 권한관리, 모든 스케줄 관리
2. **직원 권한**: 개인 스케줄 관리, 공유 스케줄 확인
3. **고객 권한**: 퍼블릭 스케줄 확인, 개인 활동 관리

## 3. 모드별 기능 정의

### 3.1 워크모드 (Work Mode)

### 3.1.1 공통 기능

- **워크플레이스 선택**: 현재 모드의 워크플레이스 목록에서 선택
- **역할 표시**: 선택된 워크플레이스에서의 역할명 표시
- **스케줄 관리**: 워크플레이스별 스케줄 생성/수정/삭제
- **프로필 설정**: 워크플레이스별 프로필 정보 관리

### 3.1.2 소유자/관리자 전용 기능

- **직원 관리**
    - 직원 목록 조회
    - 출근 기록 확인
    - 급여 정산 시스템
    - 직급별 권한 관리
    - 직원 초대/해제
- **스케줄 관리**
    - 전체 직원 스케줄 조회
    - 근무표 생성/관리
    - 휴가 신청 승인/거절
    - 스케줄 공유 설정 관리
- **워크플레이스 설정**
    - 워크플레이스 정보 수정
    - 역할명 커스터마이징
    - 권한 정책 설정
    - 직원 권한 변경 기능

### 3.1.3 직원 기능

- **개인 스케줄**: 개인 스케줄 생성/수정/삭제
- **공유 스케줄**: 팀 스케줄 확인
- **출근 기록**: 개인 출근 기록 확인
- **급여 정보**: 개인 급여 정보 조회

### 3.1.4 고객 기능

- **퍼블릭 스케줄**: 공개된 스케줄 확인
- **개인 활동**: 개인 활동 기록 관리

### 3.2 라이프모드 (Life Mode)

### 3.2.1 공통 기능

- **라이프플레이스 선택**: 개인/동호회/모임 등 라이프플레이스 선택
- **라이프플레이스 생성**: 새로운 라이프플레이스 생성 기능
- **개인 프로필**: 라이프모드용 프로필 관리
- **스케줄 관리**: 개인/모임 스케줄 관리

### 3.2.2 개인 플레이스

- **개인 스케줄**: 개인 일정 관리
- **개인 설정**: 개인별 설정 관리
- **트랙/커넥션**: 개인 소셜 네트워크 관리

### 3.2.3 모임 플레이스

- **모임 정보**: 모임 기본 정보 관리
- **모임 스케줄**: 모임 일정 공유/관리
- **모임원 관리**: 모임원 초대/관리
- **모임 설정**: 모임별 설정 관리

### 3.3 전단지 관련 기능

### 3.3.1 전단지 발행자 기능 (워크모드)

- **전단지 생성**: 홍보용 전단지 제작 및 배포
- **타겟팅 설정**: 지역, 연령, 성별 등 타겟팅 조건 설정
- **리워드 설정**: 전단지 수령 시 지급할 보상 금액 설정
- **배포 관리**: 거점형/주소형/업체별 배포 방식 선택
- **효과 분석**: 전단지 수령률, 방문 전환율 등 분석
- **비용 관리**: 전단지 배포 비용 및 리워드 지급 관리

### 3.3.2 전단지 수령자 기능 (라이프모드)

- **전단지 탐색**: 지도에서 주변 전단지 마커 확인
- **전단지 수령**: 위치 이동 후 전단지 수령 및 리워드 획득
- **지갑 관리**: 수령한 전단지의 체계적 관리
- **용도별 필터링**: 전단지/팜플렛/안내문/퀘스트 분류
- **대화창**: 전단지 관련 커뮤니케이션
- **리워드 현황**: 획득한 리워드 및 사용 내역 확인

### 3.3.3 전단지 공유 기능

- **전단지 공유**: 받은 전단지를 다른 사용자와 공유
- **공유 설정**: 공유 범위 및 권한 설정
- **공유 통계**: 전단지 공유 효과 분석
- **바이럴 마케팅**: 전단지의 바이럴 확산 지원

## 4. 스케줄 시스템

### 4.1 스케줄 공유 범위

스케줄 생성 시 다음 3가지 옵션 중 선택:

1. **개인용**: 나에게만 표시
2. **팀 공유**: 해당 워크플레이스 인원들에게만 표시
3. **공개**: 손님까지 퍼블릭하게 표시

### 4.2 스케줄 관리 기능

- **생성**: 제목, 시간, 내용, 공유범위 설정
- **수정**: 기존 스케줄 정보 수정
- **삭제**: 스케줄 삭제 (권한에 따라 제한)
- **완료 체크**: 스케줄 완료 상태 토글
- **필터링**: 공유범위별(개인용/팀 공유/공개), 날짜별 필터링

## 5. UI/UX 요구사항

### 5.1 메인 레이아웃

```
┌─────────────────────────────────────┐
│ [워크플레이스 선택] [역할명] [설정] │
├─────────────────────────────────────┤
│ 프로필 정보 (이미지, 닉네임, 역할)  │
├─────────────────────────────────────┤
│ 모드별 메뉴 탭                      │
├─────────────────────────────────────┤
│ 선택된 탭의 콘텐츠                  │
└─────────────────────────────────────┘

```

### 5.2 워크플레이스 선택 UI

- **드래그 방식**: 현재 모드의 워크플레이스 목록
- **역할 표시**: 선택된 워크플레이스에서의 역할명
- **빠른 전환**: 최근 사용 워크플레이스 하이라이트
- **전환 경고**: 작업 중인 내용이 있을 때 저장 확인 메시지 표시

### 5.3 탭 구조 (권한에 따라 동적 표시)

### 소유자/관리자 탭

1. **대시보드**: 전체 현황 요약
2. **직원관리**: 직원 목록 및 관리
3. **스케줄**: 스케줄 관리
4. **급여**: 급여 정산
5. **설정**: 워크플레이스 설정

### 직원 탭

1. **내 스케줄**: 개인 스케줄
2. **팀 스케줄**: 공유 스케줄
3. **출근기록**: 개인 출근 기록
4. **급여정보**: 개인 급여 정보

### 고객 탭

1. **공개 스케줄**: 퍼블릭 스케줄
2. **내 활동**: 개인 활동 기록

### 5.4 라이프모드 탭

1. **개인 스케줄**: 개인 일정
2. **모임 관리**: 모임 관련 기능
3. **라이프플레이스 관리**: 라이프플레이스 생성/관리
4. **전단지 지갑**: 수령한 전단지 관리
5. **설정**: 개인 설정

### 5.5 전단지 관련 탭 (모드별 동적 표시)

### 워크모드 - 전단지 발행자 탭

1. **전단지 생성**: 새로운 전단지 제작
2. **배포 관ㄱ 리**: 전단지 배포 현황 및 관리
3. **효과 분석**: 전단지 성과 분석
4. **비용 관리**: 배포 비용 및 리워드 관리

### 라이프모드 - 전단지 수령자 탭

1. **지갑**: 수령한 전단지 관리
2. **리워드**: 획득한 리워드 현황
3. **전단지 탐색**: 지도에서 전단지 찾기
4. **공유**: 전단지 공유 기능8ㅎ

## 6. 데이터베이스 구조

### 6.1 Firebase Firestore 트리 구조

```
Firestore Database
├── users
│   └── {userId}
│       ├── profile
│       │   └── info
│       │       ├── nickname
│       │       ├── email
│       │       ├── phoneNumber
│       │       ├── address
│       │       ├── profileImageUrl
│       │       ├── birthDate
│       │       ├── gender
│       │       ├── createdAt
│       │       └── updatedAt
│       │
│       ├── workplaces (subcollection)
│       │   └── {workplaceId}
│       │       ├── roleId
│       │       ├── roleName
│       │       ├── joinedAt
│       │       ├── status (active|inactive)
│       │       └── permissions
│       │
│       ├── places (subcollection)
│       │   └── {placeId}
│       │       ├── roleId
│       │       ├── roleName
│       │       ├── joinedAt
│       │       ├── status (active|inactive)
│       │       └── permissions
│       │
│       ├── schedules (subcollection)
│       │   └── {scheduleId}
│       │       ├── title
│       │       ├── time
│       │       ├── content
│       │       ├── workplaceId
│       │       ├── shareScope (personal|team|public)
│       │       ├── isCompleted
│       │       ├── createdBy
│       │       └── createdAt
│       │
│       ├── notifications (subcollection)
│       │   └── {notificationId}
│       │       ├── type
│       │       ├── title
│       │       ├── message
│       │       ├── workplaceId
│       │       ├── isRead
│       │       └── createdAt
│       │
│       └── settings
│           ├── notificationSettings
│           ├── privacySettings
│           └── workplaceSettings
│       └── wallet
│           └── {fileId}
│               ├── fileName
│               ├── fileUrl
│               ├── source
│               ├── sourceId
│               ├── receivedAt
│               └── metadata
│       └── posts (subcollection)
│           └── {postId}
│               ├── type
│               ├── title
│               ├── content
│               ├── imageUrl
│               ├── reward
│               ├── receivedAt
│               ├── isUsed
│               ├── expiresAt
│               └── metadata
│
├── workplaces
│   └── {workplaceId}
│       ├── name
│       ├── type (work|life)
│       ├── description
│       ├── address
│       ├── contactInfo
│       ├── createdBy
│       ├── createdAt
│       │
│       ├── roles (subcollection)
│       │   └── {roleId}
│       │       ├── name
│       │       ├── permissions
│       │       ├── level
│       │       └── createdAt
│       │
│       ├── members (subcollection)
│       │   └── {userId}
│       │       ├── roleId
│       │       ├── joinedAt
│       │       ├── status
│       │       └── permissions
│       │
│       ├── schedules (subcollection)
│       │   └── {scheduleId}
│       │       ├── title
│       │       ├── time
│       │       ├── content
│       │       ├── shareScope
│       │       ├── createdBy
│       │       └── createdAt
│       │
│       └── attendance (subcollection)
│           └── {userId}
│               ├── date
│               ├── checkIn
│               ├── checkOut
│               └── status
│
├── user_tracks (팔로잉)
│   └── {userId}
│       └── following (subcollection)
│           └── {targetUserId}
│               ├── createdAt
│               └── targetNickname
│
├── user_connections (맞팔)
│   └── {userId}
│       └── connections (subcollection)
│           └── {mutualUserId}
│               └── createdAt
│
└── notifications_global
    └── {notificationId}
        ├── type
        ├── title
        ├── message
        ├── targetUsers
        ├── workplaceId
        └── createdAt
│
├── posts (전단지)
│   └── {postId}
│       ├── type 
│       ├── title
│       ├── content
│       ├── imageUrl
│       ├── reward
│       ├── targetConditions
│       │   ├── location
│       │   ├── ageRange
│       │   ├── gender
│       │   └── interests
│       ├── distributionMethod
│       │   ├── type (location|address|company)
│       │   ├── coordinates
│       │   ├── address
│       │   └── companyInfo
│       ├── publisherId
│       ├── workplaceId
│       ├── status (active|inactive|expired)
│       ├── createdAt
│       └── expiresAt
│
├── post_distributions (전단지 배포)
│   └── {distributionId}
│       ├── postId
│       ├── publisherId
│       ├── distributionMethod
│       ├── targetCount
│       ├── distributedCount
│       ├── receivedCount
│       ├── totalReward
│       ├── status
│       └── createdAt
│
└── post_receipts (전단지 수령)
    └── {receiptId}
        ├── postId
        ├── receiverId
        ├── receivedAt
        ├── rewardClaimed
        ├── isUsed
        └── sharedWith

```

### 6.2 주요 데이터 모델

### 워크플레이스 데이터

```json
{
  "workplaceId": "string",
  "name": "string",
  "type": "work|life",
  "description": "string",
  "address": "string",
  "contactInfo": {
    "phone": "string",
    "email": "string"
  },
  "createdBy": "string",
  "createdAt": "timestamp"
}

```

### 사용자-워크플레이스 관계

```json
{
  "userId": "string",
  "workplaceId": "string",
  "roleId": "string",
  "roleName": "string",
  "joinedAt": "timestamp",
  "status": "active|inactive",
  "permissions": ["array"]
}

```

### 스케줄 데이터

```json
{
  "scheduleId": "string",
  "workplaceId": "string",
  "createdBy": "string",
  "title": "string",
  "time": "string",
  "content": "string",
  "shareScope": "personal|team|public",
  "isCompleted": "boolean",
  "createdAt": "timestamp"
}

```

### 알림 데이터

```json
{
  "notificationId": "string",
  "type": "schedule_shared|role_changed|employee_invited|meeting_invited|system",
  "title": "string",
  "message": "string",
  "workplaceId": "string",
  "isRead": "boolean",
  "createdAt": "timestamp"
}

```

## 7. 기술 요구사항

### 7.1 기존 코드 활용

- **UserProvider**: 사용자 정보 관리 확장
- **ScheduleService**: 스케줄 기능 확장
- **Firebase 구조**: 기존 구조 활용하여 확장
- **ModeSwitcher**: 워크/라이프 모드 전환 위젯 활용

### 7.2 새로운 서비스 필요

- **WorkplaceService**: 워크플레이스 관리
- **RoleService**: 역할 및 권한 관리
- **EmployeeService**: 직원 관리 (소유자/관리자용)
- **NotificationService**: 알림 시스템 관리
- **AttendanceService**: 출근 기록 관리
- **LeafletService**: 전단지 생성 및 배포 관리
- **LeafletWalletService**: 전단지 지갑 및 수령 관리
- **RewardService**: 리워드 지급 및 관리
- **DistributionService**: 전단지 배포 방식 관리

### 7.3 상태 관리

- **WorkplaceProvider**: 현재 선택된 워크플레이스 상태
- **RoleProvider**: 현재 사용자 역할 상태
- **ModeProvider**: 워크/라이프 모드 상태
- **NotificationProvider**: 알림 상태 관리

## 8. 구현 우선순위

### 8.1 Phase 1 (1차 구현)

1. 워크플레이스 선택 기능
2. 역할 기반 UI 동적 표시
3. 스케줄 공유범위 기능
4. 기본 탭 구조 구현
5. 워크플레이스 전환 시 저장 확인 기능
6. 스케줄 필터링 기능

### 8.2 Phase 2 (2차 구현)

1. 직원 관리 기능 (소유자/관리자용)
2. 출근 기록 시스템
3. 급여 정산 시스템
4. 권한 관리 시스템
5. 직원 권한 변경 기능
6. 알림 시스템

### 8.3 Phase 3 (3차 구현)

1. 라이프플레이스 기능
2. 라이프플레이스 생성 기능
3. 모임 관리 기능
4. 고급 설정 기능
5. 통계 및 분석 기능
6. 전단지 지갑 기본 기능
7. 전단지 수령 및 관리 기능

### 8.4 Phase 4 (4차 구현)

1. 전단지 발행자 기능
2. 전단지 배포 시스템
3. 리워드 시스템
4. 전단지 효과 분석
5. 전단지 공유 기능
6. 바이럴 마케팅 지원

## 9. 데이터 마이그레이션

### 9.1 기존 데이터 처리

- **기존 스케줄**: 모든 기존 스케줄을 "개인용"으로 설정하여 안전하게 마이그레이션
- **사용자 권한**: 소유자가 필요에 따라 스케줄별 공유범위를 수동으로 변경
- **워크플레이스 정보**: 기존 워크플레이스 데이터를 새로운 구조로 변환

## 10. 알림 시스템

### 10.1 알림 유형

- **스케줄 공유**: 새로운 스케줄이 공유될 때
- **권한 변경**: 직원의 권한이 변경될 때
- **직원 초대**: 새로운 직원이 초대될 때
- **모임 초대**: 새로운 모임에 초대될 때
- **시스템 알림**: 중요한 시스템 변경사항

### 10.2 알림 설정

- **알림 ON/OFF**: 사용자별 알림 설정
- **알림 범위**: 워크플레이스별 알림 설정
- **알림 방식**: 푸시 알림, 인앱 알림

## 11. 제외 기능 (후순위)

- 재고관리 시스템
- 고급 분석 도구
- 외부 시스템 연동

## 12. 성공 지표

- 사용자별 워크플레이스 전환 빈도
- 스케줄 공유 기능 사용률
- 직원 관리 기능 사용률 (소유자/관리자)
- 알림 시스템 사용률
- 사용자 만족도 (모드별 기능 만족도)
- 전단지 수령률 및 리워드 지급률
- 전단지 공유 및 바이럴 확산률
- 전단지 발행자 만족도 및 재사용률
- 전단지 기반 방문 전환율